\documentclass[a4paper]{article}

\usepackage{fullpage} % Package to use full page
\usepackage{parskip} % Package to tweak paragraph skipping
\usepackage{tikz} % Package for drawing
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{enumitem}

\title{10 Recurrence Relations}
\author{Ling Tan}
\date{2018/09}

\begin{document}

\maketitle

\section*{10.2 The Second-Order Linear Homogeneous Recurrence Relation with Constant Coefficients}
\textcolor{blue}{Definition}: Let $k\in\mathbb{Z}^+$ and $C_0\neq0,C_1,C_2, \ldots, C_k\neq 0$ be real numbers. If $a_n$, for $n\geq0$, is a discrete function, then
$$C_0a_n+C_1a_{n-1}+C_2a_{n-2}+\cdots+C_ka_{n-k}=f(n),\quad n\geq k,$$
is a linear recurrence relation (with constant coefficients) of order $k$.\\
When $f(0)=0$ for all $n\geq0$, the relation is called homogeneous; otherwise, it is called non-homogeneous.\\
\\
\color{red}e.g.: \color{black} When $k=1, C_0a_n+C_1a_{n-1}=g(n)\Rightarrow a_n=-\frac{C_1}{C_0}a_{n-1}+\frac{g(n)}{C_0}$.\\
If denote $C=-\frac{C_1}{C_0}$ and $h(n)=\frac{g(n)}{C_0}$,\\
\begin{align}
    a_n&=Ca_{n-1}+h(n)\\
    \Rightarrow a_{n-1}&=Ca_{n-2}+h(n-1)\\
    \Rightarrow a_{n-2}&=Ca_{n-3}+h(n-2)\\
    &\cdots\\
    \Rightarrow a_{2}&=Ca_{1}+h(2)\\
    \Rightarrow a_{1}&=Ca_{0}+h(1)
\end{align}
If $(2)\cdot C, (3)\cdot C^2,\cdots, (5)\cdot C^{n-2}, (6)\cdot C^{n-1}$ and add them up, then we have
$$a_n=C^na_0+C^{n-1}h(1)+C^{n-2}h(2)+\cdots + Ch(n-1)+h(n)=C^na_0+\sum_{i=0}^{n-1}{C^ih(n-i)}$$

\section*{10.4 The Method of Generating Functions}
Example 10.38: Solve the relation $a_n-3a_{n-1}=n,n\geq 1, a_0=1$.
\begin{align*}
    (n=1)&\quad\quad a_1-3a_0=1 & a_1x^1-3a_0x^1=1x^1\\
    (n=2)&\quad\quad a_2-3a_1=2 & a_2x^2-3a_1x^2=2x^2\\
    \vdots\quad&\quad\quad\quad\quad \vdots &\vdots\quad\quad\quad\quad\\
\end{align*}
Add the second set of equations, we find that
\begin{equation} \label{eq:1}
\sum_{n=1}^{\infty}{a_nx^n}-3\sum_{n=1}^{\infty}{a_{n-1}x^n}=\sum_{n=1}^{\infty}{nx^n}
\end{equation}

Let $f(x)=\sum_{n=0}^{\infty}{a_nx^n}$ be the (ordinary) generating function for the sequence $a_0,a_1,\ldots$. Then the equation \ref{eq:1} can be rewritten as
\begin{align*}
    \big(f(x)-a_0\big)-3x\sum_{n=1}^{\infty}{a_{n-1}x^{n-1}}&=\sum_{n=1}^{\infty}{nx^n}=\sum_{n=0}^{\infty}{nx^n}\\
    \big(f(x)-a_0\big)-3xf(x)&=\sum_{n=0}^{\infty}{nx^n}\\
    \big(f(x)-1\big)-3xf(x)&=\frac{x}{(1-x)^2}\\
    f(x)&=\frac{1}{1-3x}+\frac{x}{(1-x)^2(1-3x)}
\end{align*}
Using a partial fraction decomposition, we find that
\begin{equation*}
    \frac{x}{(1-x)^2(1-3x)}=\frac{A}{1-x}+\frac{B}{(1-x)^2}+\frac{C}{1-3x}
\end{equation*}
\\
Example 10.39: Consider the recurrence relation
    $$
    a_{n+2}-5a_{n+1}+6a_n=2,\quad n\geq0,\quad a_0=3,\quad a_1=7.
    $$
\begin{enumerate}
    \item We first multiply this given relation by $x^{n+2}$ because $n+2$ is the \textcolor{red}{largest subscript} that appears.
    \label{step1}
    $$
    a_{n+2}x^{n+2}-5a_{n+1}x^{n+2}+6a_nx^{n+2}=2x^{n+2}
    $$
    \item The we sum all of the equations represented by the result in step \ref{step1} and obtain
    $$
    \sum_{n=0}^{\infty}{a_{n+2}x^{n+2}}-5\sum_{n=0}^{\infty}{a_{n+1}x^{n+2}}+6\sum_{n=0}^{\infty}{a_nx^{n+2}}=2\sum_{n=0}^{\infty}{x^{n+2}}
    $$
    \label{step2}
    \item In order to have each of the subscripts on $a$ match the corresponding exponent on $x$, rewrite the equation in step \ref{step2} as
    $$
    \sum_{n=0}^{\infty}{a_{n+2}x^{n+2}}-5x\sum_{n=0}^{\infty}{a_{n+1}x^{n+1}}+6x^2\sum_{n=0}^{\infty}{a_nx^{n}}=2x^2\sum_{n=0}^{\infty}{x^{n}}
    $$
    \label{step3}
    \item Let $f(x)=\sum_{n=0}^{\infty}{a_nx^n}$ be the generating function for the solution. The equation in step \ref{step3} now takes the form
    $$
    \big(f(x)-a_0-a_1x\big)-5x\big(f(x)-a_0\big)+6x^2f(x)=\frac{2x^2}{1-x},
    $$
    that is,
    $$
    \big(f(x)-3-7x\big)-5x\big(f(x)-3\big)+6x^2f(x)=\frac{2x^2}{1-x}.
    $$
    \item Solve for $f(x)$
    \begin{equation*}
        (1-5x+6x^2)f(x)=3-8x+\frac{2x^2}{1-x}=\frac{3-11x+10x^2}{1-x},
    \end{equation*}
    from which it follows that
    \begin{equation*}
        f(x)=\frac{3-11x+10x^2}{(1-5x+6x^2)(1-x)}=\frac{3-5x}{(1-3x)(1-x)}=\frac{2}{1-3x}+\frac{1}{1-x}=2\sum_{n=0}^{\infty}{(3x)^n}+\sum_{n=0}^{\infty}{x^n}.
    \end{equation*}
    Consequently, $a_n=2(3^n)+1,n\geq 0$.
\end{enumerate}

Example 10.40: $a(n,r)$ denote select $r$ from $n$ distinct objects with repetition.
\begin{equation*}
a(n,r)=\binom{n+r-1}{r},
\end{equation*}
with $a(n,0)=1,a(0,r)=0\text{ for }\forall{r>0},a(0,0)=1$.\\
Let $\{b_{1},b_{2},\ldots,b_{n}\}$ be the set of these objects, and consider $b_1$.
\begin{equation*}
a(n,r)=
\begin{cases}
b_1\text{ is selected}&\Rightarrow a(n,r-1)\\
b_1\text{ is not selected}&\Rightarrow a(n-1,r)
\end{cases}
\end{equation*}
Let $f_n=\sum_{r=0}^{\infty}{a(n,r)x^r}$ be the generating function for the sequence $a(n,0),a(n,1),\ldots$.
\begin{align*}
    a(n,r)&=a(n,r-1)+ a(n-1,r)\\
    a(n,r)x^r&=a(n,r-1)x^r+ a(n-1,r)x^r&\text{multiply } x^r\\
    \sum_{r=1}^{\infty}{a(n,r)x^r}&=\sum_{r=1}^{\infty}{a(n,r-1)x^r}+ \sum_{r=1}^{\infty}{a(n-1,r)x^r}&\text{sum}\\
    \sum_{r=1}^{\infty}{a(n,r)x^r}&=x\sum_{r=1}^{\infty}{a(n,r-1)x^{r}}+ \sum_{r=1}^{\infty}{a(n-1,r)x^r}\\
    f_n-a(n,0)&=xf_n+\big(f_{n-1}-a(n-1,0)\big)\\
    f_n-1&=xf_n+f_{n-1}-1\\
    f_n&=\frac{f_{n-1}}{(1-x)}=\frac{f_{n-2}}{(1-x)^2}=\cdots=\frac{f_0}{(1-x)^n}=\frac{1}{(1-x)^n}\\
    \Rightarrow &\text{ Coefficient of }x^r\text{ is }\binom{-n}{r}(-1)^r=\binom{n+r-1}{r}
\end{align*}
Example 10.41: 
\end{document}